logging {
  level  = "info"
  format = "logfmt"
}

discovery.kubernetes "pods" {
  role = "pod"
}

otelcol.receiver.otlp "otlp" {
  protocols {
    grpc {}
    http {}
  }
}

otelcol.exporter.tempo "tempo" {
  endpoint = "http://tempo:4317"
}

otelcol.exporter.prometheus "prometheus" {
  endpoint = "0.0.0.0:9464"
}

otelcol.exporter.loki "loki" {
  endpoint = "http://loki:3100/loki/api/v1/push"
}

otelcol.service "default" {
  pipelines {
    traces = [
      otelcol.receiver.otlp.otlp,
      otelcol.exporter.tempo.tempo,
    ]

    metrics = [
      otelcol.receiver.otlp.otlp,
      otelcol.exporter.prometheus.prometheus,
    ]

    logs = [
      otelcol.receiver.otlp.otlp,
      otelcol.exporter.loki.loki,
    ]
  }
}